{
	"$schema": "https://raw.githubusercontent.com/cloudflare/workers-sdk/main/packages/wrangler/config-schema.json",
	"name": "owokx",
	"main": "src/index.ts",
	"compatibility_date": "2024-12-01",
	"compatibility_flags": [
		"nodejs_compat"
	],
	"vars": {
		"ENVIRONMENT": "staging",
		"FEATURE_LLM_RESEARCH": "true",
		"FEATURE_OPTIONS": "true",
		"ALERTS_ENABLED": "true",
		"ALERT_CHANNELS": "console,discord,webhook",
		"ALERT_DEDUPE_WINDOW_SECONDS": "900",
		"ALERT_RATE_LIMIT_MAX_PER_WINDOW": "6",
		"ALERT_RATE_LIMIT_WINDOW_SECONDS": "300",
		"ALERT_DLQ_WARN_THRESHOLD": "1",
		"ALERT_DLQ_CRITICAL_THRESHOLD": "10",
		"ALERT_LLM_AUTH_WINDOW_SECONDS": "900",
		"ALERT_DRAWDOWN_WARN_RATIO": "0.8",
		"DEFAULT_MAX_POSITION_PCT": "0.10",
		"DEFAULT_MAX_NOTIONAL_PER_TRADE": "5000",
		"DEFAULT_MAX_SYMBOL_EXPOSURE_PCT": "0.25",
		"DEFAULT_MAX_CORRELATED_EXPOSURE_PCT": "0.50",
		"DEFAULT_MAX_PORTFOLIO_DRAWDOWN_PCT": "0.15",
		"DEFAULT_MAX_DAILY_LOSS_PCT": "0.02",
		"DEFAULT_COOLDOWN_MINUTES": "30",
		"DEFAULT_MAX_OPEN_POSITIONS": "10",
		"DEFAULT_APPROVAL_TTL_SECONDS": "300"
	},
	"env": {
		"production": {
			"vars": {
				"ENVIRONMENT": "production",
				"FEATURE_LLM_RESEARCH": "true",
				"FEATURE_OPTIONS": "true",
				"ALERTS_ENABLED": "true",
				"ALERT_CHANNELS": "console,discord,webhook",
				"ALERT_DEDUPE_WINDOW_SECONDS": "900",
				"ALERT_RATE_LIMIT_MAX_PER_WINDOW": "6",
				"ALERT_RATE_LIMIT_WINDOW_SECONDS": "300",
				"ALERT_DLQ_WARN_THRESHOLD": "1",
				"ALERT_DLQ_CRITICAL_THRESHOLD": "10",
				"ALERT_LLM_AUTH_WINDOW_SECONDS": "900",
				"ALERT_DRAWDOWN_WARN_RATIO": "0.8",
				"DEFAULT_MAX_POSITION_PCT": "0.10",
				"DEFAULT_MAX_NOTIONAL_PER_TRADE": "5000",
				"DEFAULT_MAX_SYMBOL_EXPOSURE_PCT": "0.25",
				"DEFAULT_MAX_CORRELATED_EXPOSURE_PCT": "0.50",
				"DEFAULT_MAX_PORTFOLIO_DRAWDOWN_PCT": "0.15",
				"DEFAULT_MAX_DAILY_LOSS_PCT": "0.02",
				"DEFAULT_COOLDOWN_MINUTES": "30",
				"DEFAULT_MAX_OPEN_POSITIONS": "10",
				"DEFAULT_APPROVAL_TTL_SECONDS": "300"
			},
			"d1_databases": [
				{
					"binding": "DB",
					"database_name": "owokx_db",
					"database_id": "c89f38a6-2144-4ca3-9fc0-9ba6f7d75345",
					"remote": true
				}
			],
			"kv_namespaces": [
				{
					"binding": "CACHE",
					"id": "efacea07c43a440a8a182a377b1c7104",
					"remote": true
				}
			],
			"r2_buckets": [
				{
					"binding": "ARTIFACTS",
					"bucket_name": "owokx-artifacts"
				}
			],
			"durable_objects": {
				"bindings": [
					{
						"name": "SESSION",
						"class_name": "SessionDO"
					},
					{
						"name": "MCP_AGENT",
						"class_name": "owokxMcpAgent"
					},
					{
						"name": "OWOKX_HARNESS",
						"class_name": "owokxHarness"
					},
					{
						"name": "DATA_SCOUT",
						"class_name": "DataScout"
					},
					{
						"name": "ANALYST",
						"class_name": "Analyst"
					},
					{
						"name": "TRADER",
						"class_name": "Trader"
					},
					{
						"name": "SWARM_REGISTRY",
						"class_name": "SwarmRegistry"
					},
					{
						"name": "RISK_MANAGER",
						"class_name": "RiskManager"
					},
					{
						"name": "LEARNING_AGENT",
						"class_name": "LearningAgent"
					}
				]
			}
		}
	},
	// Secrets (set via `wrangler secret put <NAME>`):
	// Required:
	// - OWOKX_API_TOKEN (API authentication - generate with: openssl rand -base64 48)
	// - KILL_SWITCH_SECRET (emergency kill switch + approval token signing)
	// - BROKER_PROVIDER ("alpaca" | "okx" | "polymarket", default: "alpaca")
	// - BROKER_FALLBACK_PROVIDER (optional fallback broker id)
	// - BROKER_FALLBACK_ALLOW_TRADING ("true" to allow create/cancel order failover, default: "false")
	//
	// Broker credentials (based on BROKER_PROVIDER):
	// Alpaca:
	// - ALPACA_API_KEY
	// - ALPACA_API_SECRET
	// - ALPACA_PAPER ("true" for paper trading)
	// OKX:
	// - OKX_API_KEY
	// - OKX_SECRET
	// - OKX_PASSPHRASE
	// - OKX_SIMULATED_TRADING ("true" to enable demo trading)
	// Polymarket:
	// - POLYMARKET_API_KEY
	// - POLYMARKET_API_SECRET (base64 API secret)
	// - POLYMARKET_API_PASSPHRASE
	// - POLYMARKET_ADDRESS
	// - POLYMARKET_API_URL (optional CLOB endpoint override)
	// - POLYMARKET_DATA_API_URL (optional Data API endpoint override; defaults to https://data-api.polymarket.com)
	// - POLYMARKET_ORDER_SIGNER_URL (required for order placement unless signing is handled in-process)
	// 
	// LLM Provider (choose one mode):
	// - LLM_PROVIDER ("openai-raw" | "ai-sdk" | "vercel-gateway", default: "openai-raw")
	// - LLM_MODEL (model identifier, e.g. "gpt-4o-mini" or "anthropic/claude-sonnet-4")
	//
	// Provider API Keys (based on LLM_PROVIDER mode):
	// - OPENAI_API_KEY (for openai-raw, or ai-sdk with OpenAI models)
	// - OPENAI_BASE_URL (optional override for OpenAI-compatible proxy; affects openai-raw and ai-sdk OpenAI models)
	// - ANTHROPIC_API_KEY (for ai-sdk with Anthropic models)
	// - GOOGLE_GENERATIVE_AI_API_KEY (for ai-sdk with Google models)
	// - XAI_API_KEY (for ai-sdk with xAI/Grok models)
	// - DEEPSEEK_API_KEY (for ai-sdk with DeepSeek models)
	// - AI_GATEWAY_API_KEY (for vercel-gateway unified access)
	//
	// Optional:
	// - TWITTER_BEARER_TOKEN
	// - DISCORD_WEBHOOK_URL
	// - ALERT_WEBHOOK_URL (generic JSON webhook target for alert notifications)
	"d1_databases": [
		{
			"binding": "DB",
			"database_name": "owokx_db",
			"database_id": "c89f38a6-2144-4ca3-9fc0-9ba6f7d75345",
			"remote": true
		}
	],
	"kv_namespaces": [
		{
			"binding": "CACHE",
			"id": "efacea07c43a440a8a182a377b1c7104",
			"remote": true
		}
	],
	"r2_buckets": [
		{
			"binding": "ARTIFACTS",
			"bucket_name": "owokx-artifacts"
		}
	],
	"durable_objects": {
		"bindings": [
			{
				"name": "SESSION",
				"class_name": "SessionDO"
			},
			{
				"name": "MCP_AGENT",
				"class_name": "owokxMcpAgent"
			},
			{
				"name": "OWOKX_HARNESS",
				"class_name": "owokxHarness"
			},
			{
				"name": "DATA_SCOUT",
				"class_name": "DataScout"
			},
			{
				"name": "ANALYST",
				"class_name": "Analyst"
			},
			{
				"name": "TRADER",
				"class_name": "Trader"
			},
			{
				"name": "SWARM_REGISTRY",
				"class_name": "SwarmRegistry"
			},
			{
				"name": "RISK_MANAGER",
				"class_name": "RiskManager"
			},
			{
				"name": "LEARNING_AGENT",
				"class_name": "LearningAgent"
			}
		]
	},
	"migrations": [
		{
			"tag": "v1",
			"new_sqlite_classes": [
				"SessionDO",
				"owokxMcpAgent",
				"owokxHarness"
			]
		},
		{
			"tag": "v2",
			"new_sqlite_classes": [
				"DataScout",
				"Analyst",
				"Trader"
			]
		},
		{
			"tag": "v3",
			"new_sqlite_classes": [
				"SwarmRegistry",
				"RiskManager"
			]
		},
		{
			"tag": "v4",
			"new_sqlite_classes": [
				"LearningAgent"
			]
		}
	],
	"triggers": {
		"crons": [
			"*/5 13-20 * * 1-5",
			"0 14 * * 1-5",
			"30 21 * * 1-5",
			"0 5 * * *",
			"0 * * * *"
		]
	},
	"build": {
		"command": "npm run build"
	},
	"dev": {
		"port": 8787
	}
}
